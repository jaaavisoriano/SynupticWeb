---
import Layout from '../layouts/Layout.astro';
import Header from '../components/Header.astro';
import Footer from '../components/Footer.astro';

const faqs = [
  {
    question: 'En la agencia tenemos un acuerdo de confidencialidad con los clientes muy estricto, ¿trabajar con vosotros puede suponer un problema?',
    answer: 'Por supuesto que no. Antes de empezar a colaborar con un nuevo cliente, siempre firmamos un acuerdo marco de confidencialidad que garantiza la protección de toda la información sensible. Tratamos cada proyecto con la máxima discreción y profesionalidad.'
  },
  {
    question: 'Estamos buscando un perfil para cubrir una baja en el departamento científico de nuestra agencia, ¿podéis ayudarnos con eso?',
    answer: 'Por supuesto, en este caso tienes varias opciones. Una es contarnos tus necesidades y valorar la conveniencia de contratar una bolsa de horas científicas para cubrir el trabajo durante la ausencia. La otra opción es ayudarte a "fichar" a un talento científico a través de nuestra red de profesionales especializados en healthcare.'
  },
  {
    question: 'Mi cliente me ha encargado traducir materiales internacionales para el mercado español, ¿podéis hacer este trabajo?',
    answer: 'Sin duda. Aunque es muy importante tener en cuenta que este tipo de encargo no supone solo la traducción del inglés al español. Hay que adaptar los mensajes a la normativa nacional, revisar las referencias bibliográficas, ajustar los datos de prescripción al mercado local y asegurar que todo cumple con el código AEMPS.'
  },
  {
    question: '¿Podéis estar presentes en las reuniones con nuestros clientes? Nosotros no nos vemos capaces de contar la "parte científica" del proyecto.',
    answer: 'Claro que sí. Nos encanta ayudaros desde que recibís el briefing hasta que se presenta la propuesta al cliente. Podemos asistir a reuniones, resolver dudas científicas en tiempo real y aportar credibilidad técnica a vuestras propuestas. Trabajamos como una extensión de vuestro equipo.'
  },
  {
    question: '¿Podéis encargaros de coordinar a un grupo de expertos para crear los contenidos de un proyecto?',
    answer: 'Nos encanta coordinar a los expertos y ayudarles en todo lo que puedan necesitar. Gestionamos las agendas, facilitamos la comunicación, realizamos las entrevistas, sintetizamos sus aportaciones y nos aseguramos de que los contenidos finales reflejen fielmente su conocimiento y experiencia.'
  },
  {
    question: '¿Cómo se elaboran los presupuestos?',
    answer: 'Trabajamos con un tarifario en función de la tarea científica a realizar en cada proyecto. En base a la petición, se estima el tiempo necesario para completar el trabajo con la calidad que nos caracteriza. Siempre ofrecemos presupuestos cerrados y transparentes, sin sorpresas.'
  },
  {
    question: '¿Cómo estar seguros de que no trabajáis con nuestra competencia, por ejemplo, preparando un concurso?',
    answer: 'Trabajamos con muchas agencias y para muchos laboratorios, por lo que es imprescindible comunicar cualquier conflicto de intereses desde el primer momento. Siempre sabréis si nos ha contactado otra agencia antes para el mismo proyecto y respetaremos vuestra prioridad.'
  }
];

const faqSchema = {
  "@context": "https://schema.org",
  "@type": "FAQPage",
  "mainEntity": faqs.map(faq => ({
    "@type": "Question",
    "name": faq.question,
    "acceptedAnswer": {
      "@type": "Answer",
      "text": faq.answer
    }
  }))
};
---

<Layout 
  title="Dudas Razonables"
  description="Resuelve tus dudas sobre agencia de medical writing, confidencialidad, tarifas y colaboración externa."
  jsonld={faqSchema}
>
  <div id="wrap_all">
    <Header />
    
    <main id="main-content">
      <!-- Premium Hero Section -->
      <section class="premium-hero">
        <!-- Animated Gradient Background -->
        <div class="hero-gradient"></div>
        
        <!-- Floating Particles -->
        <div class="floating-particles">
          <span class="particle"></span>
          <span class="particle"></span>
          <span class="particle"></span>
          <span class="particle"></span>
          <span class="particle"></span>
        </div>
        
        <!-- Decorative Elements -->
        <div class="hero-decoration">
          <div class="deco-circle deco-circle--1"></div>
          <div class="deco-circle deco-circle--2"></div>
        </div>
        
        <div class="cesis_container">
          <div class="hero-content">
            <span class="hero-eyebrow">Dudas Razonables</span>
            <h1 class="hero-title">
              <span class="title-line title-line--1">Si aún te quedan dudas</span>
              <span class="title-line title-line--2">aquí tienes <em>las respuestas</em></span>
            </h1>
            <div class="hero-divider"></div>
            <p class="hero-subtitle">
              Preguntas más frecuentes que nos hacen nuestros clientes
            </p>
            <p class="hero-lema">¡Todo claro!</p>
            
            <div class="hero-cta">
              <button type="button" onclick="window.openContactModal()" class="btn-premium" aria-label="Resolver otras dudas">
                <span class="btn-icon">✉</span>
                <span>Resolver otras dudas</span>
                <div class="btn-glow"></div>
              </button>
            </div>
            
            <!-- Scroll Indicator -->
            <div class="scroll-indicator" aria-hidden="true">
              <div class="scroll-mouse">
                <div class="scroll-wheel"></div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- FAQ Section -->
      <section class="section faq-section">
        <div class="cesis_container">
          <div class="faq-list">
            {faqs.map((faq, index) => (
              <div class="faq-item" data-index={index}>
                <button class="faq-question" aria-expanded="false">
                  <span>{faq.question}</span>
                  <svg class="faq-icon" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="6 9 12 15 18 9"></polyline>
                  </svg>
                </button>
                <div class="faq-answer">
                  <p>{faq.answer}</p>
                </div>
              </div>
            ))}
          </div>
        </div>
      </section>



      <!-- CTA Section - Premium Design -->
      <section class="section cta-section">
        <div class="cta-bg">
          <div class="cta-pattern"></div>
        </div>
        <div class="cesis_container">
          <div class="cta-content">
            <h2>¿Tienes otras dudas?</h2>
            <div class="line-divider center light"></div>
            <p>Si tu pregunta no aparece aquí, escríbenos y te contestamos encantados.</p>
            <button type="button" onclick="window.openContactModal()" class="btn-premium btn-premium--light" aria-label="Abrir formulario de contacto">
              <span>Contactar</span>
              <div class="btn-glow"></div>
            </button>
          </div>
        </div>
      </section>
    </main>
    
    <Footer />
  </div>
</Layout>

<script>
  // FAQ Accordion functionality
  function initAccordion() {
    document.querySelectorAll('.faq-question').forEach(button => {
      // Prevent adding duplicate listeners if function runs multiple times
      if (button.dataset.hasListener) return;
      button.dataset.hasListener = "true";

      button.addEventListener('click', () => {
        const item = button.closest('.faq-item');
        if (!item) return;
        
        const isExpanded = button.getAttribute('aria-expanded') === 'true';
        
        // Close all other items
        document.querySelectorAll('.faq-item').forEach(otherItem => {
          if (otherItem !== item) {
            otherItem.classList.remove('is-open');
            otherItem.querySelector('.faq-question')?.setAttribute('aria-expanded', 'false');
          }
        });
        
        // Toggle current item
        item.classList.toggle('is-open');
        button.setAttribute('aria-expanded', String(!isExpanded));
      });
    });
  }

  // Initialize on page load (Astro View Transitions compatible)
  document.addEventListener('astro:page-load', initAccordion);
  
  // Fallback for initial load if not using View Transitions or if script runs before event
  // (Optional, but safe with the check above)
  initAccordion();
</script>

<style>
  /* ===== PREMIUM HERO ===== */
  .premium-hero {
    position: relative;
    min-height: 80vh;
    display: flex;
    align-items: center;
    justify-content: center;
    overflow: hidden;
    padding: 120px 0 80px;
  }
  
  .hero-gradient {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      135deg, 
      #0a1628 0%, 
      #1a3865 25%, 
      #0f2240 50%, 
      #1a3865 75%, 
      #0a1628 100%
    );
    background-size: 400% 400%;
    animation: gradientShift 12s ease-in-out infinite;
  }
  
  @keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }
  
  .floating-particles {
    position: absolute;
    inset: 0;
    overflow: hidden;
    pointer-events: none;
  }
  
  .particle {
    position: absolute;
    width: 6px;
    height: 6px;
    background: rgba(149, 204, 165, 0.4);
    border-radius: 50%;
    animation: float 8s ease-in-out infinite;
  }
  
  .particle:nth-child(1) { left: 10%; top: 20%; animation-delay: 0s; }
  .particle:nth-child(2) { left: 80%; top: 30%; animation-delay: 1.5s; }
  .particle:nth-child(3) { left: 30%; top: 70%; animation-delay: 3s; }
  .particle:nth-child(4) { left: 60%; top: 80%; animation-delay: 4.5s; }
  .particle:nth-child(5) { left: 90%; top: 60%; animation-delay: 6s; }
  
  @keyframes float {
    0%, 100% {
      transform: translateY(0) translateX(0) scale(1);
      opacity: 0.3;
    }
    50% {
      transform: translateY(-40px) translateX(-20px) scale(1.5);
      opacity: 0.8;
    }
  }
  
  .hero-decoration {
    position: absolute;
    inset: 0;
    pointer-events: none;
  }
  
  .deco-circle {
    position: absolute;
    border-radius: 50%;
    opacity: 0.1;
  }
  
  .deco-circle--1 {
    width: 500px;
    height: 500px;
    background: radial-gradient(circle, #95cca5 0%, transparent 70%);
    top: -200px;
    right: -150px;
  }
  
  .deco-circle--2 {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, #95cca5 0%, transparent 70%);
    bottom: -150px;
    left: -100px;
  }
  
  .hero-content {
    position: relative;
    z-index: 10;
    text-align: center;
    max-width: 900px;
    margin: 0 auto;
    padding: 0 24px;
  }
  
  .hero-eyebrow {
    display: inline-block;
    font-size: 13px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
    color: #95cca5;
    margin-bottom: 20px;
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 0.2s;
  }
  
  .hero-title {
    font-family: 'Raleway', sans-serif;
    font-size: clamp(28px, 5vw, 48px);
    font-weight: 700;
    color: #ffffff;
    line-height: 1.2;
    margin-bottom: 24px;
  }
  
  .title-line {
    display: block;
  }
  
  .title-line--1 {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease forwards 0.3s;
  }
  
  .title-line--2 {
    opacity: 0;
    transform: translateY(20px);
    animation: fadeInUp 0.8s ease forwards 0.5s;
  }
  
  .title-line--2 em {
    font-style: normal;
    color: #95cca5;
    position: relative;
  }
  
  .hero-divider {
    width: 80px;
    height: 3px;
    background: linear-gradient(90deg, transparent, #95cca5, transparent);
    margin: 0 auto 24px;
    opacity: 0;
    animation: fadeInScale 0.6s ease forwards 0.7s;
  }
  
  @keyframes fadeInScale {
    from {
      opacity: 0;
      transform: scaleX(0);
    }
    to {
      opacity: 1;
      transform: scaleX(1);
    }
  }
  
  .hero-subtitle {
    font-size: clamp(16px, 2.5vw, 20px);
    color: rgba(255, 255, 255, 0.85);
    max-width: 700px;
    margin: 0 auto 24px;
    line-height: 1.7;
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 0.8s;
  }
  
  .hero-lema {
    font-size: clamp(22px, 3vw, 32px);
    font-weight: 700;
    color: #95cca5;
    font-style: italic;
    margin: 0;
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 1s;
    text-shadow: 0 0 30px rgba(149, 204, 165, 0.3);
  }
  
  .hero-cta {
    margin-top: 32px;
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 1.2s;
  }
  
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .scroll-indicator {
    position: absolute;
    bottom: -60px;
    left: 0;
    right: 0;
    margin: 0 auto;
    width: fit-content;
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    opacity: 0;
    animation: fadeInUp 0.8s ease forwards 1.5s;
  }
  
  .scroll-mouse {
    width: 26px;
    height: 42px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-radius: 15px;
    display: flex;
    justify-content: center;
    padding-top: 8px;
  }
  
  .scroll-wheel {
    width: 4px;
    height: 8px;
    background: #95cca5;
    border-radius: 2px;
    animation: scrollWheel 2s ease-in-out infinite;
  }
  
  @keyframes scrollWheel {
    0%, 100% { opacity: 1; transform: translateY(0); }
    50% { opacity: 0.3; transform: translateY(10px); }
  }


  
  .faq-section {
    padding: 100px 0;
    background: var(--color-bg-body);
  }
  
  .faq-list {
    max-width: 800px;
    margin: 0 auto;
  }
  
  .faq-item {
    background: var(--color-bg-card);
    border: 1px solid var(--color-border-theme);
    border-radius: 16px;
    margin-bottom: 20px;
    overflow: hidden;
    box-shadow: 0 10px 30px rgba(0,0,0,0.05);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .faq-item:hover {
    box-shadow: 0 15px 40px rgba(0,0,0,0.1);
    transform: translateY(-2px);
    border-color: rgba(149, 204, 165, 0.3);
  }
  
  .faq-question {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 28px;
    background: none;
    border: none;
    cursor: pointer;
    text-align: left;
    font-size: 18px;
    font-weight: 600;
    color: var(--color-heading);
    gap: 16px;
    transition: background-color 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .faq-question:hover {
    background: var(--color-bg-subtle);
  }
  
  .faq-icon {
    flex-shrink: 0;
    transition: transform 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
    color: #95cca5;
  }
  
  .faq-item.is-open .faq-icon {
    transform: rotate(180deg);
  }
  
  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.4s ease;
    opacity: 0;
  }
  
  .faq-item.is-open .faq-answer {
    max-height: 500px;
    opacity: 1;
  }
  
  .faq-answer p {
    padding: 0 28px 32px;
    font-size: 16px;
    line-height: 1.7;
    color: var(--color-text-muted);
    margin: 0;
  }

  /* ===== CTA SECTION ===== */
  .cta-section {
    position: relative;
    padding: 100px 0;
    overflow: hidden;
  }
  
  .cta-bg {
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, #1a3865 0%, #0f2240 50%, #1a3865 100%);
  }
  
  .cta-pattern {
    position: absolute;
    inset: 0;
    background-image: radial-gradient(circle at 20% 50%, rgba(149,204,165,0.1) 0%, transparent 50%),
                      radial-gradient(circle at 80% 50%, rgba(149,204,165,0.08) 0%, transparent 40%);
  }
  
  .cta-content {
    position: relative;
    z-index: 10;
    text-align: center;
  }
  
  .cta-content h2 {
    font-size: clamp(32px, 5vw, 48px);
    color: #ffffff;
    margin-bottom: 20px;
    font-family: 'Raleway', sans-serif;
    font-weight: 700;
  }
  
  .line-divider.light {
    background: linear-gradient(90deg, transparent, #95cca5, transparent);
  }
  
  .cta-content p {
    font-size: clamp(16px, 2.5vw, 20px);
    color: #ffffff;
    margin-bottom: 32px;
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
    opacity: 0.9;
  }

  /* ===== PREMIUM BUTTON ===== */
  .btn-premium {
    position: relative;
    display: inline-flex;
    align-items: center;
    gap: 12px;
    padding: 18px 36px;
    background: linear-gradient(135deg, #1a3865 0%, #2c5282 100%);
    color: #ffffff;
    border: none;
    border-radius: 50px;
    font-family: 'Raleway', sans-serif;
    font-size: 14px;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 1.5px;
    cursor: pointer;
    overflow: hidden;
    transition: all 0.5s cubic-bezier(0.16, 1, 0.3, 1);
    box-shadow: 0 10px 30px rgba(26, 56, 101, 0.3);
    text-decoration: none;
  }
  
  .btn-premium:hover {
    transform: translateY(-4px) scale(1.02);
    box-shadow: 0 20px 40px rgba(26, 56, 101, 0.4);
  }
  
  .btn-premium .btn-glow {
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
    transition: left 0.5s ease;
  }
  
  .btn-premium:hover .btn-glow {
    left: 100%;
  }
  
  .btn-premium--light {
    background: #95cca5;
    color: #1a3865;
    box-shadow: 0 10px 30px rgba(149, 204, 165, 0.3);
  }
  
  .btn-premium--light:hover {
    background: #ffffff;
    box-shadow: 0 20px 40px rgba(149, 204, 165, 0.4);
  }

  /* ===== RESPONSIVE ===== */
  @media (max-width: 767px) {
    .premium-hero {
      min-height: 60vh;
      padding: 100px 0 60px;
    }

    .scroll-indicator {
      display: none;
    }
    
    .faq-section,
    .cta-section {
      padding: 70px 0;
    }

    .btn-icon {
      display: none;
    }
  }
</style>
